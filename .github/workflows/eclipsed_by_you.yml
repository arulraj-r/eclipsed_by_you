name: üì§ Instagram & Facebook ecplised_by_you

on:
  workflow_dispatch:  # Manual run button
  
  schedule:
    # Morning (8 AM ‚Äì 10 AM IST)
    - cron: '30 2 * * *'   # 08:00 AM IST
    - cron: '30 4 * * *'   # 10:00 AM IST

    # Late Morning / Early Afternoon (11 AM ‚Äì 1 PM IST)
   
    - cron: '30 7 * * *'   # 01:00 PM IST

    # Evening Slot (6 PM ‚Äì 9 PM IST)
    - cron: '30 12 * * *'  # 06:00 PM IST
    - cron: '30 15 * * *'  # 09:00 PM IST


jobs:
  autopost:
    runs-on: ubuntu-latest
    name: Run eclipsed_by_you_post

    steps:
    - name: üìÅ Checkout repository
      uses: actions/checkout@v3

    - name: üêç Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: "3.11"

    - name: üì¶ Install dependencies
      run: |
        pip install requests python-telegram-bot==13.15 dropbox pytz moviepy==1.0.3

    - name: üîê eclipsed_by_you_post
      env:
        # Meta/Instagram/Facebook
        META_TOKEN: ${{ secrets.META_TOKEN }}
        IG_ID: ${{ secrets.IG_ID }}
        FB_PAGE_ID: ${{ secrets.FB_PAGE_ID }}
        IG_COLLABORATOR_ID: ${{ secrets.IG_COLLABORATOR_ID }}
        FB_COLLABORATOR_IDS: ${{ secrets.FB_COLLABORATOR_IDS }}
        IG_SHARE_TO_FEED: ${{ secrets.IG_SHARE_TO_FEED }}

        # Dropbox
        DROPBOX_APP_KEY: ${{ secrets.DROPBOX_APP_KEY }}
        DROPBOX_APP_SECRET: ${{ secrets.DROPBOX_APP_SECRET }}
        DROPBOX_REFRESH_TOKEN: ${{ secrets.DROPBOX_REFRESH_TOKEN }}

        # Telegram
        TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}

      run: python eclipsed_by_you_post.py
